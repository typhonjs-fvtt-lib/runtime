function noop(){}const identity=t=>t;function assign(t,e){for(const n in e)t[n]=e[n];return t}const t="undefined"!=typeof window;let e=t?()=>window.performance.now():()=>Date.now(),n=t?t=>requestAnimationFrame(t):noop;const r=new Set;function run_tasks(t){r.forEach((e=>{e.c(t)||(r.delete(e),e.f())})),0!==r.size&&n(run_tasks)}function loop(t){let e;return 0===r.size&&n(run_tasks),{promise:new Promise((n=>{r.add(e={c:t,f:n})})),abort(){r.delete(e)}}}Promise.resolve();const o=[];function writable(t,e=noop){let n;const r=new Set;function set(e){if(i=e,((s=t)!=s?i==i:s!==i||s&&"object"==typeof s||"function"==typeof s)&&(t=e,n)){const e=!o.length;for(const e of r)e[1](),o.push(e,t);if(e){for(let t=0;t<o.length;t+=2)o[t][0](o[t+1]);o.length=0}}var s,i}return{set,update:function(e){set(e(t))},subscribe:function(o,s=noop){const i=[o,s];return r.add(i),1===r.size&&(n=e(set)||noop),o(t),()=>{r.delete(i),0===r.size&&(n(),n=null)}}}}function is_date(t){return"[object Date]"===Object.prototype.toString.call(t)}function tick_spring(t,e,n,r){if("number"==typeof n||is_date(n)){const o=r-n,s=(n-e)/(t.dt||1/60),i=(s+(t.opts.stiffness*o-t.opts.damping*s)*t.inv_mass)*t.dt;return Math.abs(i)<t.opts.precision&&Math.abs(o)<t.opts.precision?r:(t.settled=!1,is_date(n)?new Date(n.getTime()+i):n+i)}if(Array.isArray(n))return n.map(((o,s)=>tick_spring(t,e[s],n[s],r[s])));if("object"==typeof n){const o={};for(const s in n)o[s]=tick_spring(t,e[s],n[s],r[s]);return o}throw new Error(`Cannot spring ${typeof n} values`)}function spring(t,n={}){const r=writable(t),{stiffness:o=.15,damping:s=.8,precision:i=.01}=n;let a,c,f,u=t,p=t,l=1,d=0,b=!1;function set(n,o={}){p=n;const s=f={};if(null==t||o.hard||m.stiffness>=1&&m.damping>=1)return b=!0,a=e(),u=n,r.set(t=p),Promise.resolve();if(o.soft){const t=!0===o.soft?.5:+o.soft;d=1/(60*t),l=0}return c||(a=e(),b=!1,c=loop((e=>{if(b)return b=!1,c=null,!1;l=Math.min(l+d,1);const n={inv_mass:l,opts:m,settled:!0,dt:60*(e-a)/1e3},o=tick_spring(n,u,t,p);return a=e,u=t,r.set(t=o),n.settled&&(c=null),!n.settled}))),new Promise((t=>{c.promise.then((()=>{s===f&&t()}))}))}const m={set,update:(e,n)=>set(e(p,t),n),subscribe:r.subscribe,stiffness:o,damping:s,precision:i};return m}function get_interpolator(t,e){if(t===e||t!=t)return()=>t;const n=typeof t;if(n!==typeof e||Array.isArray(t)!==Array.isArray(e))throw new Error("Cannot interpolate values of different type");if(Array.isArray(t)){const n=e.map(((e,n)=>get_interpolator(t[n],e)));return t=>n.map((e=>e(t)))}if("object"===n){if(!t||!e)throw new Error("Object cannot be null");if(is_date(t)&&is_date(e)){t=t.getTime();const n=(e=e.getTime())-t;return e=>new Date(t+e*n)}const n=Object.keys(e),r={};return n.forEach((n=>{r[n]=get_interpolator(t[n],e[n])})),t=>{const e={};return n.forEach((n=>{e[n]=r[n](t)})),e}}if("number"===n){const n=e-t;return e=>t+e*n}throw new Error(`Cannot interpolate ${n} values`)}function tweened(t,n={}){const r=writable(t);let o,s=t;function set(i,a){if(null==t)return r.set(t=i),Promise.resolve();s=i;let c=o,f=!1,{delay:u=0,duration:p=400,easing:l=identity,interpolate:d=get_interpolator}=assign(assign({},n),a);if(0===p)return c&&(c.abort(),c=null),r.set(t=s),Promise.resolve();const b=e()+u;let m;return o=loop((e=>{if(e<b)return!0;f||(m=d(t,i),"function"==typeof p&&(p=p(t,i)),f=!0),c&&(c.abort(),c=null);const n=e-b;return n>p?(r.set(t=i),!1):(r.set(t=m(l(n/p))),!0)})),o.promise}return{set,update:(e,n)=>set(e(s,t),n),subscribe:r.subscribe}}export{spring,tweened};
//# sourceMappingURL=motion.js.map
